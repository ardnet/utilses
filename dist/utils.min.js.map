{"version":3,"sources":["utils.min.js","/source/utils.js","/source/src/components/localstorage/LS.js","/source/src/utils.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","exports","module","define","amd","utils","this","LS","_ls","window","localStorage","_listening","_listeners","value","val","undefined","remove","oldValue","get","setItem","_serialize","setTimeout","_change","call","newValue","url","location","defaultVal","_deserialize","getItem","removeItem","clear","ret","forEach","callback","addEventListener","document","bind","attachEvent","console","log","e","fire","listener","uri","event","all","push","_listen","ns","lenght","splice","indexOf","fn","JSON","stringify","parse","greet","utils___ls"],"mappings":"AAEA,QAASA,iBAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAFhH,GAAIC,cAAe,WAAe,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,MAAO,UAAUR,EAAae,EAAYC,GAAiJ,MAA9HD,IAAYZ,EAAiBH,EAAYiB,UAAWF,GAAiBC,GAAab,EAAiBH,EAAagB,GAAqBhB,OCAhiB,SAAUkB,EAAQC,GACE,gBAAZC,UAA0C,mBAAXC,QAAyBA,OAAOD,QAAUD,IAC9D,kBAAXG,SAAyBA,OAAOC,IAAMD,OAAOH,GACpDD,EAAOM,MAAQL,KACfM,KAAM,WAAc,YDUpB,IETIC,GAAA,WAEO,QAFPA,KFWA5B,gBAAgB2B,KEXhBC,GAGFD,KAAKE,IAAMC,OAAOC,aAClBJ,KAAKK,YAAa,EAClBL,KAAKM,cFqJL,MAxIA7B,cElBEwB,IFmBAZ,IAAK,MACLkB,MEZD,SAAClB,EAAKmB,GAEP,GAAYC,SAARD,EACF,MAAOR,MAAKU,OAAOrB,EAGrB,IAAIsB,GAAWX,KAAKY,IAAIvB,EAUxB,OATAW,MAAKE,IAAIW,QAAQxB,EAAKW,KAAKc,WAAWN,IAEtCO,WAAWf,KAAKgB,QAAQC,KAAKjB,MAC3BW,SAAUA,EACVO,SAAUV,EACVW,IAAKhB,OAAOiB,SACZ/B,IAAKA,IACH,GAEGmB,KFeLnB,IAAK,MACLkB,MEbD,SAAClB,EAAKgC,GAEP,MADAN,YAAWf,KAAKgB,QAAQ,GACjBhB,KAAKsB,aAAatB,KAAKE,IAAIqB,QAAQlC,OFgBxCA,IAAK,SACLkB,MEdE,SAAClB,GACLW,KAAKE,IAAIsB,WAAWnC,MFiBlBA,IAAK,QACLkB,MEfC,WACHP,KAAKE,IAAIuB,WFkBPpC,IAAK,SACLkB,MEhBE,WACJ,GAAImB,KAMJ,OAJA1B,MAAK2B,QAAQ,SAAStC,EAAKmB,GACzBkB,EAAIrC,GAAOmB,IAGNkB,KFmBLrC,IAAK,UACLkB,MEjBG,SAACqB,GAGN,IAAK,GAFDvC,GAAAoB,OAEK5B,EAAI,EAAGA,EAAImB,KAAKE,IAAIpB,OAAQD,IACnCQ,EAAMW,KAAKE,IAAIb,IAAIR,GACnB+C,EAASvC,EAAKW,KAAKY,IAAIvB,OFqBvBA,IAAK,UACLkB,MElBG,WACDJ,OAAO0B,kBAAmBC,SAASD,iBAAiB,UAAW7B,KAAKgB,QAAQe,KAAK/B,OAAO,GACxFG,OAAO6B,aAAcF,SAASE,YAAY,UAAWhC,KAAKgB,QAAQe,KAAK/B,OAAO,GAClFiC,QAAQC,IAAI,YFyBV7C,IAAK,UACLkB,MEvBG,SAAC4B,GACN,GAAIC,GAAO,SAACC,GACVA,EAASF,EAAEjB,SAAUiB,EAAExB,SAAUwB,EAAEhB,KAAOgB,EAAEG,KAG9C,IAAwB7B,SAApBT,KAAKM,WAAT,CAIK6B,IACHA,EAAIhC,OAAOoC,MAGb,IAAIC,GAAMxC,KAAKM,WAAW6B,EAAE9C,IAExBmD,IACFA,EAAIb,QAAQS,OF2BZ/C,IAAK,KACLkB,MExBF,SAAClB,EAAKuC,GACF5B,KAAKM,WAAWjB,IAClBW,KAAKM,WAAWjB,GAAKoD,KAAKb,GAC1BK,QAAQC,IAAIlC,KAAKM,cAEjBN,KAAKM,WAAWjB,IAAQuC,GACxBK,QAAQC,IAAIlC,KAAKM,aAGdN,KAAKK,aACRL,KAAK0C,UACLT,QAAQC,IAAI,6BF4BZ7C,IAAK,MACLkB,MEzBD,SAAClB,EAAKuC,GACP,GAAIe,GAAK3C,KAAKM,WAAWjB,EAErBsD,GAAGC,OAAS,EACdD,EAAGE,OAAOF,EAAGG,QAAQC,IAAK,GAE1B/C,KAAKM,WAAWjB,SF6BhBA,IAAK,aACLkB,MEzBM,SAACA,GACT,MAAOyC,MAAKC,UAAU1C,MF4BpBlB,IAAK,eACLkB,ME1BQ,SAACA,GACX,GAAqB,gBAAVA,GACT,MAAOE,OAGT,KACE,MAAOuC,MAAKE,MAAM3C,GAClB,MAAO4B,GACP,MAAO5B,IAASE,YA3HhBR,KCHAF,GACJoD,MAAK,WACH,MAAO,UAJXC,EAQU,GAAInD,EF6IZ,OE3IFE,QAAOD,IAVPkD,EFqJSrD","file":"utils.min.js","sourcesContent":[null,"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  global.utils = factory()\n}(this, function () { 'use strict';\n\n  /*global window*/\n  /**\n   *\n   */\n\n  class LS {\n\n    constructor() {\n      this._ls = window.localStorage;\n      this._listening = false;\n      this._listeners = {};\n    }\n\n    set(key, val) {\n\n      if (val === undefined) {\n        return this.remove(key);\n      }\n\n      let oldValue = this.get(key);\n      this._ls.setItem(key, this._serialize(val));\n\n      setTimeout(this._change.call(this ,{\n        oldValue: oldValue,\n        newValue: val,\n        url: window.location,\n        key: key\n      }), 0);\n\n      return val;\n    }\n\n    get(key, defaultVal) {\n      setTimeout(this._change,0);\n      return this._deserialize(this._ls.getItem(key));\n    }\n\n    remove(key) {\n      this._ls.removeItem(key);\n    }\n\n    clear() {\n      this._ls.clear();\n    }\n\n    getAll() {\n      var ret = {};\n\n      this.forEach(function(key, val) {\n        ret[key] = val;\n      });\n\n      return ret;\n    }\n\n    forEach(callback) {\n      let key;\n\n      for (let i = 0; i < this._ls.length; i++) {\n        key = this._ls.key(i);\n        callback(key, this.get(key));\n      }\n    }\n\n    _listen() {\n      if (window.addEventListener) {document.addEventListener('storage', this._change.bind(this), false);}\n      if (window.attachEvent) {document.attachEvent('storage', this._change.bind(this), false);}\n      console.log('bind!');\n    }\n\n    _change(e) {\n      let fire = (listener) => {\n        listener(e.newValue, e.oldValue, e.url || e.uri);\n      };\n\n      if (this._listeners === undefined) {\n        return;\n      }\n\n      if (!e) {\n        e = window.event;\n      }\n\n      let all = this._listeners[e.key];\n\n      if (all) {\n        all.forEach(fire);\n      }\n    }\n\n    on(key, callback) {\n      if (this._listeners[key]) {\n        this._listeners[key].push(callback);\n        console.log(this._listeners);\n      } else {\n        this._listeners[key] = [callback];\n        console.log(this._listeners);\n      }\n\n      if (!this._listening) {\n        this._listen();\n        console.log('to wazne wykonalo sie');\n      }\n    }\n\n    off(key, callback) {\n      let ns = this._listeners[key];\n\n      if (ns.lenght > 1) {\n        ns.splice(ns.indexOf(fn), 1);\n      } else {\n        this._listeners[key] = [];\n      }\n\n    }\n\n    _serialize(value) {\n      return JSON.stringify(value);\n    }\n\n    _deserialize(value) {\n      if (typeof value !== 'string') {\n        return undefined;\n      }\n\n      try {\n        return JSON.parse(value);\n      } catch (e) {\n        return value || undefined;\n      }\n    }\n  }\n\n  const utils = {\n    greet() {\n      return 'hello';\n    }\n  };\n\n  let utils___ls = new LS();\n\n  window._ls = utils___ls;\n\n  return utils;\n\n}));\n","/*global window*/\n/**\n *\n */\n\nclass LS {\n\n  constructor() {\n    this._ls = window.localStorage;\n    this._listening = false;\n    this._listeners = {};\n  }\n\n  set(key, val) {\n\n    if (val === undefined) {\n      return this.remove(key);\n    }\n\n    let oldValue = this.get(key);\n    this._ls.setItem(key, this._serialize(val));\n\n    setTimeout(this._change.call(this ,{\n      oldValue: oldValue,\n      newValue: val,\n      url: window.location,\n      key: key\n    }), 0);\n\n    return val;\n  }\n\n  get(key, defaultVal) {\n    setTimeout(this._change,0);\n    return this._deserialize(this._ls.getItem(key));\n  }\n\n  remove(key) {\n    this._ls.removeItem(key);\n  }\n\n  clear() {\n    this._ls.clear();\n  }\n\n  getAll() {\n    var ret = {};\n\n    this.forEach(function(key, val) {\n      ret[key] = val;\n    });\n\n    return ret;\n  }\n\n  forEach(callback) {\n    let key;\n\n    for (let i = 0; i < this._ls.length; i++) {\n      key = this._ls.key(i);\n      callback(key, this.get(key));\n    }\n  }\n\n  _listen() {\n    if (window.addEventListener) {document.addEventListener('storage', this._change.bind(this), false);}\n    if (window.attachEvent) {document.attachEvent('storage', this._change.bind(this), false);}\n    console.log('bind!');\n  }\n\n  _change(e) {\n    let fire = (listener) => {\n      listener(e.newValue, e.oldValue, e.url || e.uri);\n    };\n\n    if (this._listeners === undefined) {\n      return;\n    }\n\n    if (!e) {\n      e = window.event;\n    }\n\n    let all = this._listeners[e.key];\n\n    if (all) {\n      all.forEach(fire);\n    }\n  }\n\n  on(key, callback) {\n    if (this._listeners[key]) {\n      this._listeners[key].push(callback);\n      console.log(this._listeners);\n    } else {\n      this._listeners[key] = [callback];\n      console.log(this._listeners);\n    }\n\n    if (!this._listening) {\n      this._listen();\n      console.log('to wazne wykonalo sie');\n    }\n  }\n\n  off(key, callback) {\n    let ns = this._listeners[key];\n\n    if (ns.lenght > 1) {\n      ns.splice(ns.indexOf(fn), 1);\n    } else {\n      this._listeners[key] = [];\n    }\n\n  }\n\n  _serialize(value) {\n    return JSON.stringify(value);\n  }\n\n  _deserialize(value) {\n    if (typeof value !== 'string') {\n      return undefined;\n    }\n\n    try {\n      return JSON.parse(value);\n    } catch (e) {\n      return value || undefined;\n    }\n  }\n}\n\nexport {LS};\n","import {LS} from './components/localstorage/LS.js';\n\nconst utils = {\n  greet() {\n    return 'hello';\n  }\n};\n\nlet _ls = new LS();\n\nwindow._ls = _ls;\n\nexport default utils;\n\n"],"sourceRoot":"/source/"}