function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.utils=t()}(this,function(){"use strict";var e=function(){function e(){_classCallCheck(this,e),this._ls=window.localStorage,this._listening=!1,this._listeners={}}return _createClass(e,[{key:"set",value:function(e,t){if(void 0===t)return this.remove(e);var n=this.get(e);return this._ls.setItem(e,this._serialize(t)),setTimeout(this._change.call(this,{oldValue:n,newValue:t,url:window.location,key:e}),0),t}},{key:"get",value:function(e,t){return setTimeout(this._change,0),this._deserialize(this._ls.getItem(e))}},{key:"remove",value:function(e){this._ls.removeItem(e)}},{key:"clear",value:function(){this._ls.clear()}},{key:"getAll",value:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e}},{key:"forEach",value:function(e){for(var t=void 0,n=0;n<this._ls.length;n++)t=this._ls.key(n),e(t,this.get(t))}},{key:"_listen",value:function(){window.addEventListener&&document.addEventListener("storage",this._change.bind(this),!1),window.attachEvent&&document.attachEvent("storage",this._change.bind(this),!1),console.log("bind!")}},{key:"_change",value:function(e){var t=function(t){t(e.newValue,e.oldValue,e.url||e.uri)};if(void 0!==this._listeners){e||(e=window.event);var n=this._listeners[e.key];n&&n.forEach(t)}}},{key:"on",value:function(e,t){this._listeners[e]?(this._listeners[e].push(t),console.log(this._listeners)):(this._listeners[e]=[t],console.log(this._listeners)),this._listening||(this._listen(),console.log("to wazne wykonalo sie"))}},{key:"off",value:function(e,t){var n=this._listeners[e];n.lenght>1?n.splice(n.indexOf(fn),1):this._listeners[e]=[]}},{key:"_serialize",value:function(e){return JSON.stringify(e)}},{key:"_deserialize",value:function(e){if("string"!=typeof e)return void 0;try{return JSON.parse(e)}catch(t){return e||void 0}}}]),e}(),t={greet:function(){return"hello"}},n=new e;return window._ls=n,t});
//# sourceMappingURL=utils.min.js.map